{
    "unique_key": "synthetic/docker_pipelines:synthetic_docker_pipeline_01_intertwino.py",
    "repo": "synthetic-generator-v2",
    "repo_url": "https://github.com/internal/synthetic-dags",
    "stars": 0,
    "license": "MIT",
    "file_path": "synthetic/synthetic_docker_pipeline_01_intertwino.py",
    "detected_airflow_version": "2.x",
    "sampled_versions": [
      {
        "version": "latest",
        "commit": "synthetic_generation",
        "code": "from airflow import DAG\nfrom airflow.providers.docker.operators.docker import DockerOperator\nfrom airflow.utils.dates import days_ago\nfrom docker.types import Mount\nimport os\n\n# Define default arguments\ndefault_args = {\n    'owner': 'airflow',\n    'depends_on_past': False,\n    'email_on_failure': False,\n    'email_on_retry': False,\n    'retries': 1,\n}\n\n# Define the absolute path to the data directory using environment variable\nhost_data_dir = os.getenv('DATA_DIR', '/Users/abubakarialidu/Documents/SEMTUI EMD PIPELINE TEST/08092024_Experiments/I2T-Intertwino Airflow/data')\n\n# Container path for internal references\ncontainer_data_dir = '/app/data'\n\n# Define the DAG\nwith DAG(\n    dag_id='pipeline_execution_dag',\n    default_args=default_args,\n    description='A DAG to run the pipeline scripts',\n    schedule_interval=None,\n    start_date=days_ago(1),\n    catchup=False,\n) as dag:\n\n    load_and_modify = DockerOperator(\n        task_id='load_and_modify',\n        image='i2t-backendwithintertwino6-load-and-modify:latest',\n        command=[\n            'python', '/app/scripts/load_and_modify.py',\n            '--api_url', os.environ.get('LOAD_MODIFY_API_URL', 'http://load-and-modify:3003/api/'),\n            '--username', os.environ.get('API_USERNAME', 'test'),\n            '--password', os.environ.get('API_PASSWORD', 'test'),\n            '--input_pattern', os.environ.get('LOAD_MODIFY_INPUT_PATTERN', '*.csv'),\n            '--output_pattern', os.environ.get('LOAD_MODIFY_OUTPUT_PATTERN', 'table_data_{}.json'),\n            '--dataset_id', os.environ.get('LOAD_MODIFY_DATASET_ID', '2'),\n            '--date_column', os.environ.get('LOAD_MODIFY_DATE_COLUMN', 'Fecha_id'),\n            '--table_name', os.environ.get('LOAD_MODIFY_TABLE_NAME', 'JOT_{}'),\n        ],\n        network_mode='app_network',\n        environment={\n            'LOAD_MODIFY_API_URL': os.environ.get('LOAD_MODIFY_API_URL', 'http://load-and-modify:3003/api/'),\n            'API_USERNAME': os.environ.get('API_USERNAME', 'test'),\n            'API_PASSWORD': os.environ.get('API_PASSWORD', 'test'),\n            'LOAD_MODIFY_INPUT_PATTERN': os.environ.get('LOAD_MODIFY_INPUT_PATTERN', '*.csv'),\n            'LOAD_MODIFY_OUTPUT_PATTERN': os.environ.get('LOAD_MODIFY_OUTPUT_PATTERN', 'table_data_{}.json'),\n            'LOAD_MODIFY_DATASET_ID': os.environ.get('LOAD_MODIFY_DATASET_ID', '2'),\n            'LOAD_MODIFY_DATE_COLUMN': os.environ.get('LOAD_MODIFY_DATE_COLUMN', 'Fecha_id'),\n            'LOAD_MODIFY_TABLE_NAME': os.environ.get('LOAD_MODIFY_TABLE_NAME', 'JOT_{}'),\n        },\n        mounts=[Mount(source=host_data_dir, target='/app/data', type='bind')],\n        mount_tmp_dir=False,\n        auto_remove=True,\n        docker_url=\"unix://var/run/docker.sock\",\n        force_pull=False,  # Set to True if you want to always pull the latest image\n        tty=True,\n    )\n\n    reconciliation = DockerOperator(\n        task_id='reconciliation',\n        image='i2t-backendwithintertwino6-reconciliation:latest',\n        command=[\n            'python', '/app/scripts/reconciliation.py',\n            '--api_url_auth', os.environ.get('RECONCILIATION_API_URL_AUTH', 'http://reconciliation:3000/api/auth'),\n            '--api_url', os.environ.get('RECONCILIATION_API_URL', 'http://reconciliation:3000/api/reconciliation'),\n            '--base_url', os.environ.get('RECONCILIATION_BASE_URL', 'http://reconciliation:3000'),\n            '--username', os.environ.get('RECONCILIATION_USERNAME', 'test'),\n            '--password', os.environ.get('RECONCILIATION_PASSWORD', 'test'),\n            '--reconciliator_id', os.environ.get('RECONCILIATION_RECONCILIATOR_ID', '1'),\n            '--column_name', os.environ.get('RECONCILIATION_COLUMN_NAME', 'column_to_reconcile'),\n            '--optional_columns', os.environ.get('RECONCILIATION_OPTIONAL_COLUMNS', ''),\n            '--input_pattern', os.environ.get('RECONCILIATION_INPUT_PATTERN', 'table_data_*.json'),\n            '--output_pattern', os.environ.get('RECONCILIATION_OUTPUT_PATTERN', 'reconciliated_data_{}.json'),\n            '--api_token', os.environ.get('API_TOKEN', ''),\n        ],\n        network_mode='app_network',\n        environment={\n            'RECONCILIATION_API_URL_AUTH': os.environ.get('RECONCILIATION_API_URL_AUTH', 'http://reconciliation:3000/api/auth'),\n            'RECONCILIATION_API_URL': os.environ.get('RECONCILIATION_API_URL', 'http://reconciliation:3000/api/reconciliation'),\n            'RECONCILIATION_BASE_URL': os.environ.get('RECONCILIATION_BASE_URL', 'http://reconciliation:3000'),\n            'RECONCILIATION_USERNAME': os.environ.get('RECONCILIATION_USERNAME', 'test'),\n            'RECONCILIATION_PASSWORD': os.environ.get('RECONCILIATION_PASSWORD', 'test'),\n            'RECONCILIATION_RECONCILIATOR_ID': os.environ.get('RECONCILIATION_RECONCILIATOR_ID', '1'),\n            'RECONCILIATION_COLUMN_NAME': os.environ.get('RECONCILIATION_COLUMN_NAME', 'column_to_reconcile'),\n            'RECONCILIATION_OPTIONAL_COLUMNS': os.environ.get('RECONCILIATION_OPTIONAL_COLUMNS', ''),\n            'RECONCILIATION_INPUT_PATTERN': os.environ.get('RECONCILIATION_INPUT_PATTERN', 'table_data_*.json'),\n            'RECONCILIATION_OUTPUT_PATTERN': os.environ.get('RECONCILIATION_OUTPUT_PATTERN', 'reconciliated_data_{}.json'),\n            'API_TOKEN': os.environ.get('API_TOKEN', ''),\n        },\n        mounts=[Mount(source=host_data_dir, target='/app/data', type='bind')],\n        mount_tmp_dir=False,\n        auto_remove=True,\n        docker_url=\"unix://var/run/docker.sock\",\n        force_pull=False,  # Set to True if you want to always pull the latest image\n        tty=True,\n    )\n\n    openmeteo_extension = DockerOperator(\n        task_id='openmeteo_extension',\n        image='i2t-backendwithintertwino6-openmeteo-extension:latest',\n        command=[\n            'python', '/app/scripts/openmeteo_extension.py',\n            '--api_url_auth', os.environ.get('OPENMETEO_API_URL_AUTH', 'http://openmeteo:3000/api/auth'),\n            '--api_url', os.environ.get('OPENMETEO_API_URL', 'http://openmeteo:3000/api/extension'),\n            '--username', os.environ.get('OPENMETEO_USERNAME', 'test'),\n            '--password', os.environ.get('OPENMETEO_PASSWORD', 'test'),\n            '--reconciliated_column_name', os.environ.get('OPENMETEO_RECONCILIATED_COLUMN_NAME', 'reconciliated_column'),\n            '--extender_id', os.environ.get('OPENMETEO_EXTENDER_ID', '1'),\n            '--properties', os.environ.get('OPENMETEO_PROPERTIES', 'temperature,humidity'),\n            '--date_column_name', os.environ.get('OPENMETEO_DATE_COLUMN_NAME', 'date'),\n            '--separator_format', os.environ.get('OPENMETEO_SEPARATOR_FORMAT', '%Y-%m-%d'),\n            '--input_pattern', os.environ.get('OPENMETEO_INPUT_PATTERN', 'reconciliated_data_*.json'),\n            '--output_pattern', os.environ.get('OPENMETEO_OUTPUT_PATTERN', 'openmeteo_extended_data_{}.json'),\n        ],\n        network_mode='app_network',\n        environment={\n            'OPENMETEO_API_URL_AUTH': os.environ.get('OPENMETEO_API_URL_AUTH', 'http://openmeteo:3000/api/auth'),\n            'OPENMETEO_API_URL': os.environ.get('OPENMETEO_API_URL', 'http://openmeteo:3000/api/extension'),\n            'OPENMETEO_USERNAME': os.environ.get('OPENMETEO_USERNAME', 'test'),\n            'OPENMETEO_PASSWORD': os.environ.get('OPENMETEO_PASSWORD', 'test'),\n            'OPENMETEO_RECONCILIATED_COLUMN_NAME': os.environ.get('OPENMETEO_RECONCILIATED_COLUMN_NAME', 'reconciliated_column'),\n            'OPENMETEO_EXTENDER_ID': os.environ.get('OPENMETEO_EXTENDER_ID', '1'),\n            'OPENMETEO_PROPERTIES': os.environ.get('OPENMETEO_PROPERTIES', 'temperature,humidity'),\n            'OPENMETEO_DATE_COLUMN_NAME': os.environ.get('OPENMETEO_DATE_COLUMN_NAME', 'date'),\n            'OPENMETEO_SEPARATOR_FORMAT': os.environ.get('OPENMETEO_SEPARATOR_FORMAT', '%Y-%m-%d'),\n            'OPENMETEO_INPUT_PATTERN': os.environ.get('OPENMETEO_INPUT_PATTERN', 'reconciliated_data_*.json'),\n            'OPENMETEO_OUTPUT_PATTERN': os.environ.get('OPENMETEO_OUTPUT_PATTERN', 'openmeteo_extended_data_{}.json'),\n        },\n        mounts=[Mount(source=host_data_dir, target='/app/data', type='bind')],\n        mount_tmp_dir=False,\n        auto_remove=True,\n        docker_url=\"unix://var/run/docker.sock\",\n        force_pull=False,  # Set to True if you want to always pull the latest image\n        tty=True,\n    )\n\n    column_extension = DockerOperator(\n        task_id='column_extension',\n        image='i2t-backendwithintertwino6-column-extension:latest',\n        command=[\n            'python', '/app/scripts/column_extension.py',\n            '--api_url_auth', os.environ.get('COLUMN_EXT_API_URL_AUTH', 'http://column-extension:3000/api/auth'),\n            '--api_url', os.environ.get('COLUMN_EXT_API_URL', 'http://column-extension:3000/api/extension'),\n            '--username', os.environ.get('COLUMN_EXT_USERNAME', 'test'),\n            '--password', os.environ.get('COLUMN_EXT_PASSWORD', 'test'),\n            '--reconciliated_column_name', os.environ.get('COLUMN_EXT_RECONCILIATED_COLUMN_NAME', 'reconciliated_column'),\n            '--properties', os.environ.get('COLUMN_EXT_PROPERTIES', 'property1,property2'),\n            '--id_extender', os.environ.get('COLUMN_EXT_ID_EXTENDER', '1'),\n            '--input_pattern', os.environ.get('COLUMN_EXT_INPUT_PATTERN', 'openmeteo_extended_data_*.json'),\n            '--output_pattern', os.environ.get('COLUMN_EXT_OUTPUT_PATTERN', 'column_extended_data_{}.json'),\n        ],\n        network_mode='app_network',\n        environment={\n            'COLUMN_EXT_API_URL_AUTH': os.environ.get('COLUMN_EXT_API_URL_AUTH', 'http://column-extension:3000/api/auth'),\n            'COLUMN_EXT_API_URL': os.environ.get('COLUMN_EXT_API_URL', 'http://column-extension:3000/api/extension'),\n            'COLUMN_EXT_USERNAME': os.environ.get('COLUMN_EXT_USERNAME', 'test'),\n            'COLUMN_EXT_PASSWORD': os.environ.get('COLUMN_EXT_PASSWORD', 'test'),\n            'COLUMN_EXT_RECONCILIATED_COLUMN_NAME': os.environ.get('COLUMN_EXT_RECONCILIATED_COLUMN_NAME', 'reconciliated_column'),\n            'COLUMN_EXT_PROPERTIES': os.environ.get('COLUMN_EXT_PROPERTIES', 'property1,property2'),\n            'COLUMN_EXT_ID_EXTENDER': os.environ.get('COLUMN_EXT_ID_EXTENDER', '1'),\n            'COLUMN_EXT_INPUT_PATTERN': os.environ.get('COLUMN_EXT_INPUT_PATTERN', 'openmeteo_extended_data_*.json'),\n            'COLUMN_EXT_OUTPUT_PATTERN': os.environ.get('COLUMN_EXT_OUTPUT_PATTERN', 'column_extended_data_{}.json'),\n        },\n        mounts=[Mount(source=host_data_dir, target='/app/data', type='bind')],\n        mount_tmp_dir=False,\n        auto_remove=True,\n        docker_url=\"unix://var/run/docker.sock\",\n        force_pull=False,  # Set to True if you want to always pull the latest image\n        tty=True,\n    )\n\n    save = DockerOperator(\n        task_id='save',\n        image='i2t-backendwithintertwino6-save:latest',\n        command=[\n            'python', '/app/scripts/save.py',\n            '--input_pattern', os.environ.get('SAVE_INPUT_PATTERN', 'column_extended_data_*.json'),\n            '--output_filename', os.environ.get('SAVE_OUTPUT_FILENAME', 'final_output.csv'),\n            '--data_directory', os.environ.get('SAVE_DATA_DIRECTORY', '/app/data'),\n        ],\n        network_mode='app_network',\n        environment={\n            'SAVE_INPUT_PATTERN': os.environ.get('SAVE_INPUT_PATTERN', 'column_extended_data_*.json'),\n            'SAVE_OUTPUT_FILENAME': os.environ.get('SAVE_OUTPUT_FILENAME', 'final_output.csv'),\n            'SAVE_DATA_DIRECTORY': os.environ.get('SAVE_DATA_DIRECTORY', '/app/data'),\n        },\n        mounts=[Mount(source=host_data_dir, target='/app/data', type='bind')],\n        mount_tmp_dir=False,\n        auto_remove=True,\n        docker_url=\"unix://var/run/docker.sock\",\n        force_pull=False,  # Set to True if you want to always pull the latest image\n        tty=True,\n    )\n\n    # Set task dependencies\n    load_and_modify >> reconciliation >> openmeteo_extension >> column_extension >> save\n"
      }
    ],
    "sampled_time": "2025-12-15T19:25:00Z",
    "analysis": {
      "is_valid_dag_file": true,
      "is_production_dag": true,
      "is_airflow_2": true,
      "processing_type": "batch",
      "has_streaming_operators": false,
      "has_ml_operators": false,
      "topology": {
        "pattern": "linear",
        "has_sensors": false,
        "has_branches": false,
        "has_fan_out": false,
        "has_fan_in": false,
        "estimated_max_parallel_width": 1,
        "estimated_branch_depth": 0,
        "has_cycles": false,
        "has_subdags": false,
        "has_task_groups": false
      },
      "tasks": {
        "total_count": 5,
        "operator_types": [
          "DockerOperator"
        ],
        "has_dynamic_mapping": false,
        "has_external_task_sensor": false
      },
      "description": "Sequential data processing pipeline executing containerized tasks via DockerOperator to ingest CSVs, perform reconciliation and weather enrichment, extend columns, and save the final output",
      "complexity_score": 4
    }
  }