Pipeline Summary:
- Pipeline ID: synthetic-generator-v2__synthetic_sensor_gated_02_database_partition_check.py
- Name: database_partition_check_etl
- Purpose: Daily ETL pipeline that waits for database partition availability, then extracts, transforms, and loads incremental orders data
- Execution model: batch
- Topology pattern: sensor_gated

Control Flow:
- Dependencies (directed edges):
  - wait_partition -> extract_incremental
  - extract_incremental -> transform
  - transform -> load

Data Artifacts / I-O Identifiers:
- table: orders (Source orders table with daily partitions)
- table: fact_orders (Target data warehouse table for orders)

External Systems:
- database: database_conn

Pipeline Steps:
1. wait_partition — wait_partition
  - Objective: Wait for daily partition to become available in the orders table
  - Mechanism: wait_poll
  - Inputs: database:orders
  - Outputs: signal:partition_available
  - Step parameters:
    - sql_query=SELECT 1 FROM information_schema.partitions WHERE table_name = 'orders' AND partition_name LIKE CONCAT(DATE_FORMAT(CURRENT_DATE, 'p%Y%m%d'), '%')
    - timeout=3600
    - poke_interval=300
  - Failure handling:
    - retries: 2
    - retry delay: PT5M
2. extract_incremental — extract_incremental
  - Objective: Extract new orders from the partitioned table
  - Mechanism: python_callable
  - Inputs: database:orders
  - Outputs: data:extracted_orders
  - Failure handling:
    - retries: 2
    - retry delay: PT5M
3. transform — transform
  - Objective: Transform extracted orders data
  - Mechanism: python_callable
  - Inputs: data:extracted_orders
  - Outputs: data:transformed_orders
  - Failure handling:
    - retries: 2
    - retry delay: PT5M
4. load — load
  - Objective: Load transformed orders to target system
  - Mechanism: python_callable
  - Inputs: data:transformed_orders
  - Outputs: database:fact_orders
  - Failure handling:
    - retries: 2
    - retry delay: PT5M
