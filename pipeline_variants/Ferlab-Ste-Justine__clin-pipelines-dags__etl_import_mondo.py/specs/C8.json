{
  "spec_version": "1.0",
  "pipeline_id": "etl_import_mondo",
  "pipeline_name": "etl_import_mondo",
  "source": {
    "unique_key": null,
    "repo": "Ferlab-Ste-Justine/clin-pipelines-dags",
    "file_path": "dags/etl_import_mondo.py",
    "repo_url": "https://github.com/Ferlab-Ste-Justine/clin-pipelines-dags",
    "detected_airflow_version": "2.x",
    "sampled_version": null,
    "sampled_commit": null,
    "sampled_time": null,
    "source_fingerprint_sha256": "de199f5c6afdbca5e2d661ce614cbf5db68a70e81b5613523ef8d2c77bb47fec"
  },
  "summary": {
    "purpose": "ETL pipeline for importing Mondo ontology data - downloads Mondo OBO file, normalizes terms using Spark, indexes to Elasticsearch, publishes results, and sends notification",
    "business_domain": "bioinformatics/clinical genomics",
    "execution_model": "batch",
    "topology_pattern": "linear",
    "notes": "Pipeline includes version checking to skip processing if data is already up-to-date"
  },
  "schedule": {
    "schedule_type": "manual",
    "schedule_expression": null,
    "timezone": null,
    "start_date": "2022-01-01",
    "catchup_backfill": null
  },
  "control_flow": {
    "edges": [
      {
        "from": "params_validate",
        "to": "download_mondo_terms"
      },
      {
        "from": "download_mondo_terms",
        "to": "normalized_mondo_terms"
      },
      {
        "from": "normalized_mondo_terms",
        "to": "index_mondo_terms"
      },
      {
        "from": "index_mondo_terms",
        "to": "publish_mondo"
      },
      {
        "from": "publish_mondo",
        "to": "slack"
      }
    ],
    "parallel_groups": [],
    "branch_points": [],
    "gates": []
  },
  "external_systems": [
    {
      "type": "http_api",
      "name": "GitHub Mondo Releases",
      "identifier": "https://github.com/monarch-initiative/mondo/releases",
      "details": [
        "Source for Mondo OBO ontology files"
      ],
      "auth": []
    },
    {
      "type": "object_storage",
      "name": "S3 Data Lake",
      "identifier": "cqgc-{env}-app-datalake",
      "details": [
        "Raw data landing zone and processed data storage"
      ],
      "auth": [
        "S3 connection"
      ]
    },
    {
      "type": "database",
      "name": "Elasticsearch",
      "identifier": null,
      "details": [
        "Index for Mondo terms"
      ],
      "auth": []
    },
    {
      "type": "cloud_service",
      "name": "Kubernetes",
      "identifier": null,
      "details": [
        "Execution environment for Spark jobs"
      ],
      "auth": []
    },
    {
      "type": "other",
      "name": "Slack",
      "identifier": null,
      "details": [
        "Notification system"
      ],
      "auth": []
    }
  ],
  "data_artifacts": {
    "files": [
      {
        "identifier": "mondo-base.obo",
        "description": "Source Mondo ontology file"
      },
      {
        "identifier": "mondo.obo",
        "description": "Downloaded Mondo file name"
      },
      {
        "identifier": "mondo_terms_template.json",
        "description": "Elasticsearch index template"
      }
    ],
    "tables": [],
    "buckets": [
      {
        "identifier": "cqgc-{env}-app-datalake/raw/landing/mondo",
        "description": "Raw Mondo file storage"
      },
      {
        "identifier": "cqgc-{env}-app-datalake/public/mondo_terms",
        "description": "Processed Mondo terms"
      }
    ],
    "topics": []
  },
  "steps": [
    {
      "step_id": "params_validate",
      "name": "params_validate",
      "objective": "Validate pipeline parameters",
      "mechanism": "python_callable",
      "inputs": [
        {
          "type": "parameter",
          "identifier": "color",
          "description": "Color parameter for deployment"
        }
      ],
      "outputs": [],
      "external_system_refs": [],
      "parameters": [
        {
          "key": "color",
          "value": ""
        }
      ],
      "env_infra": {
        "env_vars": [],
        "mounts": [],
        "network": null,
        "other": []
      },
      "failure_handling": {
        "retries": null,
        "retry_delay": null,
        "timeout": null,
        "alerts": [],
        "idempotency": []
      }
    },
    {
      "step_id": "download_mondo_terms",
      "name": "download_mondo_terms",
      "objective": "Download Mondo OBO file from GitHub releases and upload to S3",
      "mechanism": "python_callable",
      "inputs": [
        {
          "type": "external_api",
          "identifier": "https://github.com/monarch-initiative/mondo/releases",
          "description": "Mondo releases page"
        }
      ],
      "outputs": [
        {
          "type": "file",
          "identifier": "mondo.obo",
          "description": "Downloaded Mondo file"
        },
        {
          "type": "metadata",
          "identifier": "mondo.obo.version",
          "description": "Version of downloaded file"
        }
      ],
      "external_system_refs": [
        {
          "type": "http_api",
          "name": "GitHub Mondo Releases",
          "identifier": "https://github.com/monarch-initiative/mondo/releases"
        },
        {
          "type": "object_storage",
          "name": "S3 Data Lake",
          "identifier": "cqgc-{env}-app-datalake"
        }
      ],
      "parameters": [],
      "env_infra": {
        "env_vars": [],
        "mounts": [],
        "network": null,
        "other": []
      },
      "failure_handling": {
        "retries": null,
        "retry_delay": null,
        "timeout": null,
        "alerts": [],
        "idempotency": []
      }
    },
    {
      "step_id": "normalized_mondo_terms",
      "name": "normalized_mondo_terms",
      "objective": "Normalize Mondo terms using Spark processing",
      "mechanism": "spark_job",
      "inputs": [
        {
          "type": "file",
          "identifier": "mondo-base.obo",
          "description": "Source Mondo file"
        },
        {
          "type": "metadata",
          "identifier": "mondo.obo.version",
          "description": "Version from download step"
        }
      ],
      "outputs": [
        {
          "type": "processed_data",
          "identifier": "public/mondo_terms",
          "description": "Normalized Mondo terms"
        }
      ],
      "external_system_refs": [
        {
          "type": "object_storage",
          "name": "S3 Data Lake",
          "identifier": "cqgc-{env}-app-datalake"
        },
        {
          "type": "cloud_service",
          "name": "Kubernetes",
          "identifier": null
        }
      ],
      "parameters": [
        {
          "key": "spark_class",
          "value": "bio.ferlab.HPOMain"
        },
        {
          "key": "spark_config",
          "value": "config-etl-medium"
        },
        {
          "key": "k8s_context",
          "value": "ETL"
        },
        {
          "key": "exclude_root",
          "value": "MONDO:0700096"
        }
      ],
      "env_infra": {
        "env_vars": [],
        "mounts": [],
        "network": null,
        "other": [
          "Kubernetes execution context"
        ]
      },
      "failure_handling": {
        "retries": null,
        "retry_delay": null,
        "timeout": null,
        "alerts": [],
        "idempotency": []
      }
    },
    {
      "step_id": "index_mondo_terms",
      "name": "index_mondo_terms",
      "objective": "Index normalized Mondo terms to Elasticsearch",
      "mechanism": "spark_job",
      "inputs": [
        {
          "type": "processed_data",
          "identifier": "public/mondo_terms",
          "description": "Normalized terms from previous step"
        },
        {
          "type": "metadata",
          "identifier": "mondo.obo.version",
          "description": "Version from download step"
        },
        {
          "type": "template",
          "identifier": "mondo_terms_template.json",
          "description": "Elasticsearch index template"
        }
      ],
      "outputs": [
        {
          "type": "index",
          "identifier": "mondo",
          "description": "Elasticsearch index"
        }
      ],
      "external_system_refs": [
        {
          "type": "database",
          "name": "Elasticsearch",
          "identifier": null
        },
        {
          "type": "cloud_service",
          "name": "Kubernetes",
          "identifier": null
        }
      ],
      "parameters": [
        {
          "key": "spark_class",
          "value": "bio.ferlab.clin.etl.es.Indexer"
        },
        {
          "key": "spark_config",
          "value": "config-etl-singleton"
        },
        {
          "key": "index_name",
          "value": "mondo"
        },
        {
          "key": "index_type",
          "value": "mondo_terms"
        },
        {
          "key": "config_file",
          "value": "config/{env}.conf"
        }
      ],
      "env_infra": {
        "env_vars": [],
        "mounts": [],
        "network": null,
        "other": [
          "Kubernetes execution context"
        ]
      },
      "failure_handling": {
        "retries": null,
        "retry_delay": null,
        "timeout": null,
        "alerts": [],
        "idempotency": []
      }
    },
    {
      "step_id": "publish_mondo",
      "name": "publish_mondo",
      "objective": "Publish indexed Mondo data",
      "mechanism": "spark_job",
      "inputs": [
        {
          "type": "metadata",
          "identifier": "mondo.obo.version",
          "description": "Version from download step"
        },
        {
          "type": "index",
          "identifier": "mondo",
          "description": "Elasticsearch index"
        }
      ],
      "outputs": [
        {
          "type": "published_data",
          "identifier": null,
          "description": "Published Mondo index"
        }
      ],
      "external_system_refs": [
        {
          "type": "database",
          "name": "Elasticsearch",
          "identifier": null
        },
        {
          "type": "cloud_service",
          "name": "Kubernetes",
          "identifier": null
        }
      ],
      "parameters": [
        {
          "key": "color",
          "value": "{color}"
        }
      ],
      "env_infra": {
        "env_vars": [],
        "mounts": [],
        "network": null,
        "other": []
      },
      "failure_handling": {
        "retries": null,
        "retry_delay": null,
        "timeout": null,
        "alerts": [],
        "idempotency": []
      }
    },
    {
      "step_id": "slack",
      "name": "slack",
      "objective": "Send completion notification",
      "mechanism": "notification",
      "inputs": [],
      "outputs": [],
      "external_system_refs": [
        {
          "type": "other",
          "name": "Slack",
          "identifier": null
        }
      ],
      "parameters": [],
      "env_infra": {
        "env_vars": [],
        "mounts": [],
        "network": null,
        "other": []
      },
      "failure_handling": {
        "retries": null,
        "retry_delay": null,
        "timeout": null,
        "alerts": [],
        "idempotency": []
      }
    }
  ],
  "quality": {
    "confidence": "high",
    "extraction_warnings": [
      "Some parameter values contain template expressions (e.g., {env}, {color}) that require runtime resolution",
      "Spark jar parameters (spark_jar, obo_parser_spark_jar) are passed as parameters but exact values unknown",
      "Elasticsearch URL and specific connection details not visible in code snippet"
    ]
  },
  "generation": {
    "generated_at": "2025-12-16T13:46:39.304722Z"
  },
  "variant": {
    "class_id": "C8",
    "class_name": "NO_FAILURE_HANDLING_DETAILS",
    "canonical_pipeline_id": "Ferlab-Ste-Justine__clin-pipelines-dags__etl_import_mondo.py",
    "spec_pipeline_id": "etl_import_mondo"
  }
}